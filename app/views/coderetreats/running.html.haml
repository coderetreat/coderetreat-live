-content_for :head do
  %meta{"http-equiv" => "refresh", :content => "600"}

%h1 Global Day of Coderetreat Events
%p
  This is the main page for showing events that are running on December 14th,
  2013, for the #{link_to "Global Day of Coderetreat", "http://globalday.coderetreat.org"}.
  As events and sessions begin and end, this page will update with information
  about which events are at which phase.

%section.coderetreats.in_session
  %header
    %h2 In Session
  .coderetreats
    -@coderetreats.in_session do |coderetreat|
      .coderetreat
        %img.map{src: google_map_image_for(coderetreat.location)}
        .information
          %h3=coderetreat.location
          .constraints
            .current
              %img{src: "https://raw.githubusercontent.com/twitter/twemoji/gh-pages/16x16/25b6.png"}
              %span= coderetreat.current_session_constraints
            -coderetreat.previous_sessions.each do |session|
              .previous
                %img{src: "https://raw.githubusercontent.com/twitter/twemoji/gh-pages/16x16/2714.png"}
                %span= session.constraints

=render partial: "state_listing",
  collection: CoderetreatLive::Coderetreats::StateMachine::RUNNING_NON_SESSION_STATES,
  :as => :state

=render partial: "state_listing",
  collection: CoderetreatLive::Coderetreats::StateMachine::NOT_RUNNING_STATES,
  :as => :state

= render 'application/sponsors'
